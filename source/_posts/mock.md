---
title: mockjs在模块化项目中使用的思考
date: 2017-03-06 23:15:45
tags:
- 前端
- mockjs
---
最近一直在理解前后端分离。在概念上这个概念很好理解，但是实施起来却有许多细节需要整理。目前遇到的困难有：
1. 假数据怎么造？
2. 单个接口的真假数据怎么一健切换？
3. 多个借口的真假数据怎么分别一键切换？
4. 为了节约代码量，不引入新问题。正式发布的版本如何去除真假数据一键切换的开关？
5. 怎么把正式发布版本的代码自动部署？
6. 如果遇到多个测试+商用环境，如何自动部署前端代码？

上述几个问题太难了，需要慢慢整理，今天只谈前两个问题。
<!-- more -->
## 假数据怎么造？
答：用[mockjs](https://github.com/nuysoft/Mock/wiki/Getting-Started)

但是，用法很讲究，如果只是把mock的假数据写在前端代码文件中，这样前端的人写爽了。到了真正和后端同事联调的时候，就又要重新修改代码，这时候，前端开发需要做的是：
1. 把前段文件中的mock代码删除
2. 在删除mock处写新的ajax请求
3. 把接口需要的数据写在一个地方
4. 和后端人员按照mock的数据制定接口数据格式
5. 联调

这么做，很烦，对不对？

如果能像淘宝rap那样，让前端开发一上来就写ajax请求，再做一个开关，开关开时，ajax请求不被拦截，访问正式的接口；开关关时，ajax请求被拦截，由mockjs返回假数据。这么做，再与后端同事联调的时候，只需要做：
1. 把接口需要的数据写在一个地方
2. 切换开关
3. 联调

瞬间减轻了好多工作量。

然而，仅仅把mock的数据用一个开关来维护是不够的，有时，我们希望mock造出的假数据与入参数有关；有时我们希望mock造出的假数据不要每次都有变化，这样才方便前端开发调试。


## 单个接口的真假数据怎么一健切换？

在代码的逻辑文件入口（main.js），使用require（mock.js）来引入mock入口文件。